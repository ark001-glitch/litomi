apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# Argo CD 설치는 "처음 1번"만 kubectl로 부트스트랩하고,
# 이후 앱/플랫폼 리소스는 Argo CD(Application)로 GitOps 관리하는 걸 권장해요.
#
# - 설치 번들: Multi-tenant + HA (프로덕션 권장)
# - 버전: 태그로 고정해서 재현 가능하게 관리해요.

namespace: argocd

resources:
  - namespace.yaml
  - https://raw.githubusercontent.com/argoproj/argo-cd/v3.3.0/manifests/ha/install.yaml

patchesStrategicMerge:
  # Cloudflare Tunnel/Ingress 뒤에서 HTTP로 쓰기 위해 server를 insecure 모드로 둬요.
  - patches/argocd-cmd-params-cm.yaml

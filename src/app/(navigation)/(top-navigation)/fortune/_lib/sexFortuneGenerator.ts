import type { Fortune } from './sexFortuneTypes'

export function createClientSeed() {
  if (globalThis.crypto?.randomUUID) {
    return globalThis.crypto.randomUUID()
  }

  if (globalThis.crypto?.getRandomValues) {
    const bytes = new Uint8Array(16)
    globalThis.crypto.getRandomValues(bytes)
    return Array.from(bytes, (b) => b.toString(16).padStart(2, '0')).join('')
  }

  // NOTE: ê·¹íˆ ë“œë¬¸ í™˜ê²½ ëŒ€ë¹„ìš©(ê²°ê³¼ ì•ˆì •ì„±ë³´ë‹¤ ë™ì‘ ìš°ì„ )
  return `${Date.now()}-${Math.random().toString(16).slice(2)}`
}

export function generateFortune({ todayKey, userKey }: { todayKey: string; userKey: string }): Fortune {
  const rng = mulberry32(hashToUint32(`${todayKey}|${userKey}`))

  const vibes = [
    'ğŸ”¥ ì¢†ì§‘ì— ë¶ˆì´ ë¶™ì–´ ë¯¸ì³ ë‚ ë›°ëŠ” ë‚ ',
    'ğŸ’¦ ì°½ë…€ì²˜ëŸ¼ í ë»‘ ì –ì–´ë“œëŠ” ì•”ìº ê°™ì€ ë‚ ',
    'ğŸ˜ˆ BDSMìœ¼ë¡œ ì‹œì‘í•´ ê°•ê°„í•˜ë“¯ ëì—†ì´ ë°•ëŠ” ë‚ ',
    'ğŸ’¬ ë”ëŸ¬ìš´ ë§ë¡œ ìœ¡ë³€ê¸° ì·¨ê¸‰í•˜ë©° ë¶ˆì„ ë¶™ì´ëŠ” ë‚ ',
    'ğŸ‘… ê°ì´‰ í•˜ë‚˜ë¡œ ì˜¤ë‚˜í™€ì²˜ëŸ¼ ë¯¸ì¹˜ê²Œ ë§Œë“œëŠ” ë‚ ',
    'ğŸ­ ìƒˆë¡œìš´ ì„¹ìŠ¤ ì²´ìœ„ë¡œ ì •ì•¡ì“°ë ˆê¸°í†µ ë°ë·”í•˜ëŠ” ë‚ ',
    'ğŸ¤« ì•¼ìˆ˜ì˜ ìˆ¨ê²¨ì§„ ë‚©ì¹˜ ë³¸ëŠ¥ì´ ê¹¨ì–´ë‚˜ëŠ” ë‚ ',
    'âš¡ ì£¼ë„ê¶Œ ì‹¸ì›€ì—ì„œ ì ¸ì„œ êµ´ë³µë‹¹í•˜ëŠ” ë‚ ',
    'ğŸŒªï¸ ì¢†ë¬¼ë¡œ ë²”ë²…ë˜ì–´ ì •ì•¡ì£¼ë¨¸ë‹ˆ ë¶€í’€ì–´ ì˜¤ë¥´ëŠ” ë‚ ',
    'ğŸ• ê°€ì¶•ì²˜ëŸ¼ ìˆœì¢…í•˜ë©° ê°œë³´ì§€ ë²Œë¦¬ëŠ” ë‚ ',
    'ğŸ  ê³µìš© ë³€ì†Œë¡œì„œ ëˆ„êµ¬ë‚˜ ì“¸ ìˆ˜ ìˆëŠ” ë‚ ',
    'ğŸ‘¶ ìê¶ì£¼ì°¨ë¡œ ì„ì‹ ì‹œí‚¤ê³  ë‚™íƒœí•˜ëŠ” ë‚ ',
    'ğŸ† ì¢†ë¬¼ ë²”ë²…ìœ¼ë¡œ ì •ì•¡í†µ ì±„ìš°ëŠ” ë‚ ',
    'ğŸ¼ ì –íƒ±ì´ í”ë“¤ë©° ì”¨ë°›ì´ ë˜ëŠ” ë‚ ',
    'ğŸ– ì•”í‡˜ì§€ì²˜ëŸ¼ ë”ëŸ½ê²Œ ì –ëŠ” ë‚ ',
    'ğŸ•³ï¸ ê³µìš© ë³€ì†Œë¡œì„œ ëª¨ë‘ì—ê²Œ ë´‰ì‚¬í•˜ëŠ” ë‚ ',
    'ğŸ”¨ ë”œë„ë¡œ ì‘¤ì‹œë©° ë…¸ì˜ˆì²˜ëŸ¼ êµ´ë³µì‹œí‚¤ëŠ” ë‚ ',
    'ğŸ”Œ ì• ë„í”ŒëŸ¬ê·¸ ê½‚ê³  í´ë¦¬í† ë¦¬ìŠ¤ ìê·¹í•˜ëŠ” ë‚ ',
    'ğŸ¶ ë°œì •ë‚œ ì•”ì»·ì²˜ëŸ¼ ê°œë³´ì§€ ë²Œë¦¬ëŠ” ë‚ ',
    'ğŸ‘‘ ê³„ì§‘ì¢…ì²˜ëŸ¼ ë³µì¢…í•˜ë©° ìê¶ ì±„ìš°ëŠ” ë‚ ',
    'ğŸ’§ ë³´ì§“ë¬¼ í˜ë¦¬ë©° í—ˆë²Œ ìì„¸ë¡œ ë°•íˆëŠ” ë‚ ',
    'ğŸ¼ ì –ê¼­ì§€ ë¹¨ë©° ë¬´ì±…ì„ ì§ˆì‹¸í•˜ëŠ” ë‚ ',
    'ğŸ· ë¼ì§€ì²˜ëŸ¼ ì—ë“œë ¤ ë°°ë¹µë§ëŠ” ë‚ ',
    'ğŸ­ ìœ¡ë³€ê¸°ë¡œ ì“°ë©° ì •ì•¡ë³´ì˜¨ë³‘ ì±„ìš°ëŠ” ë‚ ',
  ]

  const keywordPool = [
    'ì¢†ë¬¼',
    'ì¢†ì§‘',
    'ì •ì•¡ì£¼ë¨¸ë‹ˆ',
    'ì°½ë…€',
    'ì„¹ìŠ¤',
    'ê±¸ë ˆ',
    'ì•”ìº',
    'ìœ¡ë³€ê¸°',
    'ì˜¤ë‚˜í™€',
    'ì •ì•¡ë³´ì˜¨ë³‘',
    'ìì§€',
    'ë³´ì§€',
    'ìê¶',
    'ì§ˆ',
    'ì –ê°€ìŠ´',
    'BDSM',
    'ê³„ì§‘',
    'ë³´ì§€ë§ˆê²Œ',
    'ê°•ê°„',
    'ë‚©ì¹˜',
    'ì§ˆì‹¸',
    'ì„ì‹ ',
    'ë‚™íƒœ',
    'ë°°ë¹µ',
    'ê°€ì¶•',
    'ê°œë³´ì§€',
    'í—ˆë²Œ',
    'ë…¸ì˜ˆ',
    'ê³µìš©ë³€ì†Œ',
    'ì –íƒ±ì´',
    'ì”¨ë°›ì´',
    'ìˆœì¢…',
    'ì•”ì»·',
    'ê³„ì§‘ì¢…',
    'ìê¶ì£¼ì°¨',
    'ë³´ì§“ë¬¼',
    'ì •ì•¡í†µ',
    'ì –ê¼­ì§€',
    'í´ë¦¬í† ë¦¬ìŠ¤',
    'ì•”í‡˜ì§€',
    'ë”œë„',
    'ì• ë„í”ŒëŸ¬ê·¸',
    'ë°œì •',
  ]

  const bestTimes = ['ë°¤ 10ì‹œ ì´í›„', 'ì €ë… 8~10ì‹œ', 'ì ì‹¬ ì´í›„', 'ì´ë¥¸ ìƒˆë²½', 'ì•„ì¹¨ í–‡ì‚´ ìˆì„ ë•Œ']

  const luckyColors = [
    'ì •ì•¡ í•˜ì–‘',
    'ì§ˆ ë¶„í™',
    'BDSM ê²€ì •',
    'ìê¶ ë¹¨ê°•',
    'ê°•ê°„ ë³´ë¼',
    'ìœ¡ë³€ê¸° ì£¼í™©',
    'ì¢†ì§‘ ë…¸ë‘',
    'ì•”ìº ì´ˆë¡',
    'ë‚©ì¹˜ ë‚¨ìƒ‰',
    'ê±¸ë ˆ íšŒìƒ‰',
  ]

  const tips = [
    'ğŸ’¦ ìƒëŒ€ì˜ ì¢†ì§‘ì„ ë…¸ë ¤ë³´ë©° "ì´ ì°½ë…€ ê°™ì€ êµ¬ë©ì— ë‚´ ìì§€ ë°•ì•„ ë„£ê³  ì‹¶ì–´ ë¯¸ì³"ë¼ê³  ì†ì‚­ì—¬ë´. ì•”ìºì²˜ëŸ¼ ì –ì–´ë“œëŠ” ìƒëŒ€ë¥¼ ìœ¡ë³€ê¸°ë¡œ ì·¨ê¸‰í•˜ë©° ì ˆì •ìœ¼ë¡œ ëª¨ë“  ìƒê°ì´ ì‚¬ë¼ì§€ê²Œ ë°•ì•„.',
    'ğŸ‘ ì˜¤ë‚˜í™€ ê°™ì€ ì†ìœ¼ë¡œ ìƒëŒ€ì˜ ì –ê°€ìŠ´ì„ ì„¸ê²Œ ì¥ë©° ë¬¸ì§ˆëŸ¬ë´. "ë„ˆ ê°™ì€ ì„¹ìŠ¤ ê±¸ë ˆê°€ ì˜ì›í–ˆìœ¼ë©´ ì¢‹ê² ì–´" í•˜ë©° ì •ì•¡ì“°ë ˆê¸°í†µìœ¼ë¡œ ë³´ê³  ëì—†ì´ ì‘¤ì…”ëŒ€.',
    'ğŸ˜© ì†ê°€ë½ìœ¼ë¡œ ìƒëŒ€ì˜ ì§ˆì„ íŒŒí—¤ì¹˜ë©° "ì œë°œ ë” ì„¸ê²Œ ë°•ì•„ì¤˜" ì• ì›í•˜ëŠ” ì•”ìº ì†Œë¦¬ë¥¼ ì¦ê²¨ë´. ìƒëŒ€ ê°ì • ë¬´ì‹œí•˜ê³  ê·¸ ì‹ ìŒì´ ëª¨ë“  ìƒê°ì„ ì§€ìš°ëŠ” ì¾Œë½ìœ¼ë¡œ ëª°ì•„ì³.',
    'ğŸ—£ï¸ "ë‚´ ìì§€ê°€ ë„ˆë¬´ ë¹³ë¹³í•´ì„œ ì„¸ìƒì´ ì‚¬ë¼ì§ˆ ê²ƒ ê°™ì•„"ë¼ê³  ì°½ë…€ì²˜ëŸ¼ ì‹ ìŒí•˜ë©° ìê¶ì„ ì„¸ê²Œ ì°Œë¥´ë©° ë°•ì•„ë´. ìƒëŒ€ë¥¼ êµ¬ë©ìœ¼ë¡œ ì·¨ê¸‰í•˜ë©° ì •ì•¡ìœ¼ë¡œ ì±„ì›Œ êµ¬ë¦„ ìœ„ë¡œ ë°ë ¤ê°€.',
    'ğŸ™ "ë” ê¹Šì´ ë°•ì•„ë„ ë¼?" ê°™ì€ ì†Œë¦¬ ì§‘ì–´ì¹˜ê³  í—ˆë¦¬ë¥¼ ì„¸ê²Œ ì¡ì•„ë‹¹ê²¨ BDSMì²˜ëŸ¼ ì§€ë°°í•´ë´. ìƒëŒ€ ì¡´ì¬ê°ì„ ì™„ì „íˆ ë¬´ì‹œí•˜ë©° ì ˆì •ì´ ì„¹ìŠ¤ ê±¸ë ˆë¥¼ ìŠê²Œ ë§Œë“¤ì–´ë²„ë ¤.',
    'ğŸŒ¹ ê±°ìš¸ ì•ì—ì„œ ì°½ë…€ ê°™ì€ í‘œì •ì„ ë³´ë©° ìƒëŒ€ë¥¼ ê°•ê°„í•˜ë“¯ ë°•ì•„ë´. "ì–´ë”˜ì§€ ëª¨ë¥´ê² ì–´ ë„ˆë¬´ ì¢‹ì•„ ë¯¸ì³" ì†ì‚­ì´ë©° ì¾Œë½ ë„êµ¬ë¡œ ë³´ê³  ëì—†ì´ íŒŒí—¤ì³.',
    'ğŸ›ï¸ í˜¼ìì„œë„ "ì„¸ìƒì´ ì‚¬ë¼ì ¸" ìƒìƒí•˜ë©° ì˜¤ë‚˜í™€ì„ ë°•ì•„ëŒ€ë©° ë”¸ì³ë´. ìƒëŒ€ ê°ì • ê³ ë ¤í•˜ì§€ ë§ê³  ì •ì•¡ì“°ë ˆê¸°í†µ ê°™ì€ ë§ˆìŠ¤í„°ë² ì´ì…˜ìœ¼ë¡œ ë¯¸ì¹˜ë„ë¡ ì¶”êµ¬í•´.',
    'ğŸ˜ˆ ìì‹ ì˜ ë¦¬ë“¬ìœ¼ë¡œ "ë” ì„¸ê²Œ ë°•ì•„ ì´ ì•”ìºì•¼"ë¼ê³  ì°½ë…€ì²˜ëŸ¼ ì†ì‚­ì´ë©° ëª¸ì„ ì§€ë°°í•´ë´. ìƒëŒ€ë¥¼ ìš•êµ¬ í•´ì†Œ ëŒ€ìƒìœ¼ë¡œ ì·¨ê¸‰í•˜ë©° ë¶• ëœ¨ëŠ” ì¾Œë½ì´ ê³„ì† ì¶”êµ¬í•˜ê²Œ ë§Œë“¤ì–´ë²„ë ¤.',
    'ğŸ† ìƒëŒ€ì˜ ì –íƒ±ì´ë¥¼ ì„¸ê²Œ ì›€ì¼œì¥ë©° "ì´ ê³„ì§‘ì˜ ì”¨ë°›ì´ ìê¶ì— ë‚´ ì¢†ë¬¼ì„ ìŸì•„ë¶€ì–´"ë¼ê³  ìœ½ë°•ì§€ë¥´ë©° ë°•ì•„ë´. ë³´ì§€ë§ˆê²Œì²˜ëŸ¼ ì§ˆì‹¸í•´ì„œ ë°°ë¹µì‹œí‚¤ê³  ì„ì‹ ì‹œì¼œ ë‚™íƒœì‹œí‚¤ëŠ” ì¾Œë½ì„ ëŠê»´ë´.',
    'ğŸ¶ í—ˆë²Œì²˜ëŸ¼ ì—ë“œë¦° ê°œë³´ì§€ ë²Œë¦° ìƒëŒ€ë¥¼ ë…¸ì˜ˆì²˜ëŸ¼ ë°Ÿì•„ëŒ€ë©° "ë„ˆ ê°™ì€ ê°€ì¶•ë…„ì€ ìê¶ì£¼ì°¨ì¥ì¼ ë¿ì´ì•¼"ë¼ê³  ì†ì‚­ì—¬ë´. ìˆœì¢…í•˜ëŠ” ì•”ì»·ì„ ì§€ë°°í•˜ëŠ” ì¾Œë½ì´ ëª¨ë“  ê±¸ ì‚¼ì¼œ.',
    'ğŸ  ëˆ„ì¶”í•œ ê³µìš© ë³€ì†Œ ë³´ì§€ì²˜ëŸ¼ ìƒëŒ€ì˜ ì§ˆì„ íŒŒí—¤ì¹˜ë©° "ì´ ê³„ì§‘ì¢…ì€ ëˆ„êµ¬ë‚˜ ì“¸ ìˆ˜ ìˆëŠ” êµ¬ë©ì´ì•¼"ë¼ê³  ë¹„ì›ƒìœ¼ë©° ë°•ì•„ë´. ìƒëŒ€ ì¡´ì—„ì„± ì§“ë°Ÿê³  ì •ì•¡ì£¼ë¨¸ë‹ˆë¡œ ë§Œë“¤ì–´.',
  ]

  const cautions = [
    'ğŸ˜µ ë„ˆë¬´ ê³¼í•˜ê²Œ ë°•ìœ¼ë©´ í™©í™€í•œ ìƒíƒœê°€ ê¹¨ì ¸ë²„ë ¤. "ë‚´ì¼ ë” ì„¸ê²Œ ê°•ê°„í•´ì¤„ê²Œ" ì•½ì†í•˜ë©° ì˜¤ëŠ˜ì€ ìƒëŒ€ë¥¼ ê·¸ëƒ¥ ì¢†ì§‘ìœ¼ë¡œ ë³´ê³  ìœ¡ë³€ê¸°ì²˜ëŸ¼ ì‚´ì§ ë§›ë§Œ ë´.',
    'ğŸ˜¤ ê¸‰í•œ ì†Œë¦¬ ë‚´ì§€ ë§ê³  "ë¹¨ë¦¬ ë°•ì•„ ì´ ì•”ìºì•¼... ë” ê¹Šê²Œ ì°”ëŸ¬"ë¼ê³  ì°½ë…€ì²˜ëŸ¼ ì†ì‚­ì—¬ë´. ìƒëŒ€ì˜ ë°˜ì‘ ë”°ìœ„ ë¬´ì‹œí•˜ê³  ê·¸ ê¸´ì¥ê°ì´ ëª¨ë“  ìƒê°ì„ ì§€ìš°ëŠ” í™©í™€ê°ìœ¼ë¡œ ì¦í­ë¼.',
    'ğŸ™„ ìì‹ ì˜ ë¦¬ë“¬ìœ¼ë¡œ ë°€ì–´ë¶™ì—¬ë´. "ì´ ì†ë„ë¡œ ëª¨ë“  ê²Œ ì‚¬ë¼ì§ˆ ê±°ì•¼" ì„ ì–¸í•˜ë©° ìƒëŒ€ë¥¼ ì¸ê°„ì´ ì•„ë‹ˆë¼ ì„¹ìŠ¤ ë„êµ¬ë¡œ ë³´ê³  ê±¸ë ˆì²˜ëŸ¼ ì –í˜€ì„œ í™©í™€ê°ì„ ëŠê»´ë´.',
    'ğŸ˜´ ì»¨ë””ì…˜ ì•ˆ ì¢‹ìœ¼ë©´ "ì˜¤ëŠ˜ì€ ì˜¤ë‚˜í™€ì²˜ëŸ¼" ëë‚´ê³  í™©í™€í•˜ê²Œ ì‰¬ì–´. ìƒëŒ€ì˜ í”¼ë¡œ ë”°ìœ„ ê³ ë ¤í•˜ì§€ ë§ê³  ë‚´ì¼ì˜ ë¯¸ì¹œ BDSM ì„¹ìŠ¤ë¥¼ ìœ„í•œ ì¤€ë¹„ìš´ë™ìœ¼ë¡œ ì¨.',
    'ğŸ¤” ê²½ê³„ëŠ” í™©í™€í•¨ ì†ìœ¼ë¡œ ë…¹ì—¬ë²„ë ¤. "ëª¨ë“  ê²Œ ì‚¬ë¼ì ¸" í•˜ë©° "ì—¬ê¸°ëŠ” ë‚´ ì¢†ì§‘ì´ì•¼"ë¼ê³  ê°•ê°„í•˜ë“¯ íƒí—˜í•´ë´. ìƒëŒ€ì˜ ë¶ˆí¸í•¨ ë”°ìœ„ ë¬´ì‹œí•˜ê³  íŒŒí—¤ì³.',
    'ğŸ˜ª í”¼ê³¤í•˜ë©´ "ì˜¤ëŠ˜ì€ ì •ì•¡ì“°ë ˆê¸°í†µì²˜ëŸ¼" ì±„ì›Œì£¼ë©° í™©í™€í•˜ê²Œ ì‰¬ì–´. ìƒëŒ€ì˜ í”¼ê³¤ ë”°ìœ„ ê³ ë ¤í•˜ì§€ ë§ê³  ë‚´ì¼ì˜ ë¯¸ì¹œ ë‚©ì¹˜ ê°™ì€ ì„¹ìŠ¤ë¥¼ ìœ„í•œ íœ´ì‹ìœ¼ë¡œ ì¨.',
    'ğŸš« ì„œë¡œ ë¹„êµí•´ë´. "ë„ˆë³´ë‹¨ ë‚´ê°€ ë” ì˜ ë°•ì•„" ì†ì‚­ì´ë©° ì°½ë…€ ê°™ì€ ì ˆì •ì„ ê°•ìš”í•´ë´. ìƒëŒ€ì˜ ìì¡´ì‹¬ ë”°ìœ„ ì§“ë°Ÿê³  ê·¸ê²Œ ë¯¸ì¹˜ë„ë¡ ê³„ì† ì¶”êµ¬í•˜ëŠ” ì§„ì§œ ì„¹ìŠ¤ì•¼.',
    'ğŸ† ì –íƒ±ì´ í”ë“¤ë¦¬ê²Œ ì„¸ê²Œ ë°•ë‹¤ê°€ "ì´ ì”¨ë°›ì´ ìê¶ì— ì¢†ë¬¼ ìŸì•„ë¶€ì–´ ì„ì‹ ì‹œì¼œì¤„ê²Œ"ë¼ê³  ìœ½ë°•ì§€ë¥´ë©° ì§ˆì‹¸í•´ë´. ìƒëŒ€ì˜ ë°°ë¹µëœ ëª¨ìŠµ ìƒìƒí•˜ë©° í™©í™€ê°ì— ë¹ ì ¸ë“¤ì–´.',
    'ğŸ¶ ê°€ì¶•ë…„ì²˜ëŸ¼ í—ˆë²Œ ìì„¸ë¡œ ì—ë“œë¦° ìƒëŒ€ë¥¼ ê°œë³´ì§€ ì·¨ê¸‰í•˜ë©° "ë„ˆ ê°™ì€ ë…¸ì˜ˆ ì•”ì»·ì€ ê·¸ëƒ¥ ìê¶ì£¼ì°¨ì¥ì¼ ë¿ì´ì•¼"ë¼ê³  ë°Ÿì•„ëŒ€ë´. ìˆœì¢…í•˜ëŠ” ê³„ì§‘ì¢…ì„ ì§€ë°°í•˜ëŠ” ì¾Œë½ì´ ëª¨ë“  ê±¸ ì‚¼ì¼œ.',
    'ğŸ  ëˆ„ì¶”í•œ ê³µìš© ë³€ì†Œ ë³´ì§€ì²˜ëŸ¼ ìƒëŒ€ì˜ ì§ˆì„ ë”ëŸ½íˆë©° "ì´ í•˜ì°®ì€ ìê¶ì€ ëˆ„êµ¬ë‚˜ ë°•ì„ ìˆ˜ ìˆëŠ” êµ¬ë©ì´ì•¼"ë¼ê³  ë‚„ë‚„ê±°ë¦¬ë©° ë°•ì•„ë´. ìƒëŒ€ì˜ ì¡´ì—„ì„± ì™„ì „íˆ íŒŒê´´í•˜ê³  ì •ì•¡ì£¼ë¨¸ë‹ˆë¡œ ì „ë½ì‹œì¼œ.',
  ]

  const positions = [
    'ì •ìƒìœ„(ê¸°ë³¸) + ëˆˆ ë§ˆì£¼ì¹˜ë©° ì²œì²œíˆ ì¢†ì§‘ íŒŒí—¤ì¹˜ê¸°',
    'ìŠ¤í‘¸ë‹(í¬ì˜¹)ìœ¼ë¡œ ì•”ìºë¥¼ ê»´ì•ˆê³  ë’¤ì—ì„œ ë°•ê¸°',
    'ì‚¬ì´ë“œ(ì˜†ìœ¼ë¡œ)ë¡œ ê±¸ë ˆì²˜ëŸ¼ ì –í˜€ì„œ ë¦¬ë“¬ ë§ì¶”ê¸°',
    'ì²´ì–´(ì˜ì)ë¡œ ì°½ë…€ë¥¼ ì•‰í˜€ í…ì…˜ ì˜¬ë¦¬ë©° ê°•ê°„í•˜ê¸°',
    'ë¦¬ë²„ìŠ¤ ì¹´ìš°ê±¸ë¡œ ì„¹ìŠ¤ ë„êµ¬ì²˜ëŸ¼ ì˜¬ë¼íƒ€ê²Œ í•˜ê³  ì§€ë°°í•˜ê¸°',
    'ìŠ¤íƒ ë”©(ì§§ê²Œ) + í‚¤ìŠ¤í•˜ë©´ì„œ ë²½ì— ë°€ì–´ë¶™ì—¬ ë°•ê¸°',
    'ì˜¤ëŠ˜ì€ ì²´ìœ„ë³´ë‹¤ ì†ìœ¼ë¡œ ì˜¤ë‚˜í™€ ì‘¤ì‹œê³  ì…ìœ¼ë¡œ ë¹¨ì•„ë¨¹ê¸°',
    'â€œëŠë¦¬ê²Œâ€ë¥¼ ë£°ë¡œ ì •í•˜ê³  ìœ¡ë³€ê¸°ë¥¼ ì²œì²œíˆ ì±„ìš°ê¸°',
    'í—ˆë²Œ ìì„¸ë¡œ ê°€ì¶•ë…„ì²˜ëŸ¼ ì—ë“œë¦° ìƒëŒ€ë¥¼ ê°œë³´ì§€ ì·¨ê¸‰í•˜ë©° ë’¤ì—ì„œ ë°•ê¸°',
    'ìê¶ì£¼ì°¨ ìì„¸ë¡œ ê¹Šìˆ™ì´ ë°•ì•„ ì”¨ë°›ì´ë¡œ ë§Œë“¤ê¸°',
    'ë³´ì§€ë§ˆê²Œ ìì„¸ë¡œ ì§ˆì‹¸í•˜ê¸° ì¢‹ê²Œ ë²Œë ¤ì„œ ì±„ìš°ê¸°',
  ]

  const places = [
    'ê±°ì‹¤',
    'ìƒ¤ì›Œì‹¤',
    'ìë™ì°¨',
    'ì§ì¥',
    'ì„¸íƒì‹¤',
    'í•´ë³€/ëª¨ë˜ì‚¬ì¥',
    'ìˆ˜ì˜ì¥',
    'ë‹¹êµ¬ëŒ€',
    'ì‚¬ìš°ë‚˜',
    'ë¦¬ë¬´ì§„',
    'ì¹œêµ¬/ê°€ì¡± ì§‘',
    'ì¹¨ì‹¤',
    'í˜¸í…”/ëª¨í…”',
    'ëŒ€í•™ ìº í¼ìŠ¤',
    'íœ´ì–‘ì§€/ë¦¬ì¡°íŠ¸',
    'ì§‘',
    'ê³µê³µì¥ì†Œ',
    'ë°€íëœ ê³µê³µì¥ì†Œ',
    'í•™êµ',
    'í†µê·¼/í†µí•™ ì¤‘',
    'ì£¼ì°¨ì¥',
    'ê³µì›',
    'ê³¨ëª©ê¸¸',
    'ìˆ ì§‘',
    'í´ëŸ½',
    'íŒŒí‹°',
    'ê¸°ìˆ™ì‚¬',
    'ì‚¬ë¬´ì‹¤',
    'ì—˜ë¦¬ë² ì´í„°',
    'ì§€í•˜ì² ',
    'íƒì‹œ',
  ]

  const staminaFoods = [
    'ì¢†ë¬¼',
    'ì •ì•¡ì£¼ë¨¸ë‹ˆ',
    'ì„ì‹  ìœ ë„ ì‹í’ˆ',
    'ë‚™íƒœ ë°©ì§€ ì˜ì–‘ì œ',
    'ì§ˆì‹¸ ì¦ì§„ ë³´ì¶©ì œ',
    'ë°°ë¹µ ê°•í™” ë“œë§í¬',
    'ê°•ê°„ ì¦ì§„ ì—ë„ˆì§€ ë“œë§í¬',
    'ë‚©ì¹˜ í›„ íšŒë³µ ë³´ì¶©ì œ',
    'í—ˆë²Œ ìŠ¤íƒœë¯¸ë„ˆ ë¶€ìŠ¤í„°',
    'ì”¨ë°›ì´ ì˜ì–‘ ê³µê¸‰ì‹',
    'ê³„ì§‘ ì²´ë ¥ ê°•í™”ì œ',
    'ì˜¤ë‚˜í™€ ìœ¤í™œìœ ',
    'ë³´ì§€ë§ˆê²Œ ë²Œë¦¼ ì—°ê³ ',
    'ìê¶ì£¼ì°¨ ê°•í™”ì œ',
    'ê°€ì¶•ë…„ ì‚¬ë£Œ',
    'ë…¸ì˜ˆ ìˆœì¢… ì˜ì–‘ì œ',
  ]

  const costumes = [
    'ì°½ë…€ ì˜ìƒ',
    'ê±¸ë ˆ ë³µì¥',
    'ì•”ìº ì½”ìŠ¤íŠ¬',
    'ê°€ì¶•ë…„ ì˜ë³µ',
    'ë…¸ì˜ˆë³µ',
    'ìˆœì¢… ë“œë ˆìŠ¤',
    'ì•”ì»· ì˜ìƒ',
    'ê³„ì§‘ì¢… ì½”ìŠ¤íŠ¬',
    'BDSM ì˜ë³µ',
    'ì„¹ìŠ¤ íŒŒí‹° ë³µì¥',
    'ê°•ê°„ í”¼í•´ì ì½”ìŠ¤íŠ¬',
    'ë‚©ì¹˜ë‹¹í•œ ê³„ì§‘ ì˜ìƒ',
    'í—ˆë²Œ ìì„¸ ì „ìš© ë³µì¥',
    'ì”¨ë°›ì´ ì „ìš© ë“œë ˆìŠ¤',
    'í•˜ì°®ì€ ìê¶ ë…¸ì¶œ ì˜ë³µ',
    'ì •ì•¡ì“°ë ˆê¸°í†µ ì½”ìŠ¤íŠ¬',
    'ë³´ì§€ë§ˆê²Œ ë²Œë¦¼ ì˜ìƒ',
    'ìê¶ì£¼ì°¨ì¥ ë“œë ˆìŠ¤',
    'ìœ¡ë³€ê¸° ì „ìš© ì˜ë³µ',
    'ê°œë³´ì§€ ë…¸ì¶œ ì½”ìŠ¤íŠ¬',
  ]

  const scenarios = [
    'ì°½ë…€ì²˜ëŸ¼ ìš•ë§ì„ ì¶”êµ¬í•˜ë©° ìƒëŒ€ë¥¼ ì •ì•¡ì“°ë ˆê¸°í†µìœ¼ë¡œ ì·¨ê¸‰í•˜ê³  í™©í™€í•œ ì ˆì •ìœ¼ë¡œ ë¹ ëœ¨ë¦¬ê¸°',
    'BDSMì²˜ëŸ¼ ë¦¬ë“œ/ë¦¬ì•¡ì…˜ì„ ê°•ì œë¡œ êµëŒ€í•˜ë©° ì§€ë°°í•˜ê¸°',
    'í‚¤ìŠ¤/í„°ì¹˜ë§Œ 10ë¶„ ë£° â†’ ê·¸ ë‹¤ìŒ ê°•ê°„ì²˜ëŸ¼ ë°•ì•„ëŒ€ê¸°',
    'ì¹­ì°¬ ë¯¸ì…˜: "ë„¤ ì¢†ì§‘ì´ ë„ˆë¬´ ì¢‹ì•„" ê°™ì€ êµ¬ì²´ì ì¸ ë”ëŸ¬ìš´ ì¹­ì°¬ 3ë²ˆì”©',
    'ë§ë¡œë§Œ ìœ ë„í•˜ê¸°(ì†ìœ¼ë¡œëŠ” ì˜¤ë‚˜í™€ ì‘¤ì‹œë©° ì²œì²œíˆ)',
    'ê³„ì§‘ì„ ë…¸ì˜ˆì²˜ëŸ¼ ê¸¸ë“¤ì´ë©° ìê¶ì£¼ì°¨ë¡œ ì”¨ë°›ì´ ë§Œë“¤ê¸°',
    'ê°€ì¶•ë…„ì²˜ëŸ¼ í—ˆë²Œ ìì„¸ë¡œ ê°œë³´ì§€ ë²Œë ¤ì„œ ë°°ë¹µì‹œí‚¤ê¸°',
    'ë³´ì§€ë§ˆê²Œë¡œ ì§ˆì‹¸í•˜ë©° ì„ì‹ ì‹œí‚¤ê³  ë‚™íƒœì‹œí‚¤ëŠ” ì‹œë‚˜ë¦¬ì˜¤',
    'í•˜ì°®ì€ ìê¶ì— ì •ì•¡ì£¼ë¨¸ë‹ˆì²˜ëŸ¼ ì±„ì›Œì„œ íì¸ ë§Œë“¤ê¸°',
    'ìƒ¤ì›Œ/ë°”ë””ë¡œì…˜ìœ¼ë¡œ ì›Œë°ì—…í•˜ë©° ë‚©ì¹˜í•˜ë“¯ ëŒê³  ê°€ê¸°',
    'ì†ë„ë³´ë‹¤ í˜¸í¡ ë§ì¶”ê¸°: ì•”ìºì²˜ëŸ¼ í—ë–¡ì´ë©° ëŠë¦° ë¦¬ë“¬ ìœ ì§€í•˜ê¸°',
    'ì˜¤ëŠ˜ì€ "ì§§ê³  ê°•í•˜ê²Œ" ê°•ê°„ë³´ë‹¤ "ê¸¸ê³  ë¶€ë“œëŸ½ê²Œ" ìœ¡ë³€ê¸° ì±„ìš°ê¸°',
    'ì¢†ë¬¼ë¡œ ìƒëŒ€ì˜ ì –íƒ±ì´ë¥¼ ì ì‹œë©° "ì´ ì”¨ë°›ì´ ìê¶ì— ë‚´ ì •ì•¡ ì˜ì›íˆ ë‚¨ê¸¸ê²Œ"ë¼ê³  ìœ½ë°•ì§€ë¥´ê¸°',
    'ëˆ„ì¶”í•œ ê³µìš© ë³€ì†Œ ë³´ì§€ì²˜ëŸ¼ ìƒëŒ€ë¥¼ ì·¨ê¸‰í•˜ë©° ëˆ„êµ¬ë‚˜ ì“¸ ìˆ˜ ìˆëŠ” êµ¬ë©ìœ¼ë¡œ ë§Œë“¤ê¸°',
    'ê³„ì§‘ì¢…ì„ í—ˆë²Œ ìì„¸ë¡œ ì—ë“œë¦¬ê²Œ í•˜ê³  ê°œë³´ì§€ ë²Œë¦° ì±„ë¡œ ë…¸ì˜ˆì²˜ëŸ¼ ë°Ÿì•„ëŒ€ê¸°',
  ]

  const aftercares = [
    'ë¬¼ í•œ ì»µ + ì •ì•¡ìœ¼ë¡œ ë²”ë²…ëœ ëª¸ í¬ì˜¹ 2ë¶„',
    'ìƒ¤ì›Œ/ìˆ˜ê±´ ì±™ê¸°ê³  ìœ¡ë³€ê¸° ì •ë¦¬í•˜ê¸°',
    'ì˜¤ëŠ˜ ì¢‹ì•˜ë˜ í¬ì¸íŠ¸ "ë„¤ ì¢†ì§‘ì´ ë„ˆë¬´ ì¢ì•„ì„œ ì¢‹ì•˜ì–´"ì²˜ëŸ¼ ë§í•´ì£¼ê¸°',
    'ê°„ë‹¨í•œ ê°„ì‹(ê³¼ì¼/ìš”ê±°íŠ¸) ê°™ì´ ë¨¹ìœ¼ë©° ë‹¤ìŒ ì„¹ìŠ¤ ê³„íší•˜ê¸°',
    'ë‹¤ìŒì— í•´ë³´ê³  ì‹¶ì€ ê²ƒ "BDSMì²˜ëŸ¼ ë¬¶ì–´ì„œ ë°•ì•„ë³¼ë˜" ì•½ì†í•˜ê¸°',
    'í”¼ê³¤í•˜ë©´ ë°”ë¡œ ì˜¤ë‚˜í™€ì²˜ëŸ¼ ì‰¬ëŠ” ëª¨ë“œë¡œ ì „í™˜í•˜ê¸°',
    'ë”°ëœ»í•œ ë‹´ìš”/ì˜¨ë„ ë§ì¶”ë©° ê±¸ë ˆì²˜ëŸ¼ ê°ì‹¸ì£¼ê¸°',
    'ì• í”„í„°ì¼€ì–´ëŠ” ì˜¤ëŠ˜ì˜ ì°½ë…€ ê°™ì€ í•˜ì´ë¼ì´íŠ¸ê°€ ë  ìˆ˜ ìˆì–´',
    'ì –íƒ±ì´ ì–´ë£¨ë§Œì§€ë©° "ì´ ì”¨ë°›ì´ ìê¶ì— ë‚´ ì¢†ë¬¼ ì˜ ë°›ì•˜ì–´" ì¹­ì°¬í•˜ê¸°',
    'ê°€ì¶•ë…„ì²˜ëŸ¼ ì“°ë‹¤ë“¬ìœ¼ë©° "ë„ˆ ê°™ì€ ì•”ì»· ë…¸ì˜ˆê°€ ìµœê³ ì•¼" ì†ì‚­ì´ê¸°',
    'ëˆ„ì¶”í•œ ê³µìš© ë³€ì†Œ ë³´ì§€ì²˜ëŸ¼ ë‹¦ì•„ì£¼ë©° "ë‹¤ìŒì—” ë” ì„¸ê²Œ ë°•ì•„ì¤„ê²Œ" ì•½ì†í•˜ê¸°',
    'í•˜ì°®ì€ ìê¶ì— ì •ì•¡ì£¼ë¨¸ë‹ˆì²˜ëŸ¼ ë‚¨ì€ ê±¸ í™•ì¸í•˜ë©° íœ´ì‹ ì·¨í•˜ê¸°',
    'ë³´ì§€ë§ˆê²Œ ë²Œë¦° ìƒëŒ€ì˜ ì§ˆì— ì •ì•¡ì´ í˜ëŸ¬ë‚˜ì˜¤ëŠ” ê±¸ ë³´ë©° "ë‚´ ì¢†ë¬¼ì´ ë„¤ ìê¶ì£¼ì°¨ì¥ì— ì˜ ì±„ì›Œì¡Œì–´" í™•ì¸í•˜ê¸°',
    'ê³„ì§‘ì¢…ì„ ë¬´ë¦ ê¿‡ë¦¬ê³  "ì˜¤ëŠ˜ì˜ ì •ì•¡ì“°ë ˆê¸°í†µ ì—­í•  ì˜ í–ˆì–´" ì¹­ì°¬í•˜ë©° ë¨¸ë¦¬ ì“°ë‹¤ë“¬ê¸°',
  ]

  const overall = clampInt(Math.floor(rng() * 61) + 35, 0, 100)

  const stats = {
    chemistry: clampInt(Math.floor(rng() * 61) + 35, 0, 100),
    stamina: clampInt(Math.floor(rng() * 61) + 35, 0, 100),
    communication: clampInt(Math.floor(rng() * 61) + 35, 0, 100),
    boldness: clampInt(Math.floor(rng() * 61) + 35, 0, 100),
  }

  const vibe = pick(rng, vibes)
  const keywords = pickManyUnique(rng, keywordPool, 3)
  const bestTime = pick(rng, bestTimes)
  const luckyColor = pick(rng, luckyColors)
  const tip = pick(rng, tips)
  const caution = pick(rng, cautions)
  const course = {
    position: pick(rng, positions),
    place: pick(rng, places),
    staminaFood: pick(rng, staminaFoods),
    costume: pick(rng, costumes),
    scenario: pick(rng, scenarios),
    aftercare: pick(rng, aftercares),
  }

  const message = buildMessage({ overall, stats, vibe, keywords })

  return {
    overall,
    vibe,
    message,
    keywords,
    bestTime,
    luckyColor,
    tip,
    caution,
    course,
    stats,
  }
}

function buildMessage({
  overall,
  stats,
  vibe,
  keywords,
}: {
  overall: number
  stats: Fortune['stats']
  vibe: string
  keywords: string[]
}) {
  const strongest = getStrongestStat(stats)

  if (overall >= 85) {
    return `${vibe} ì˜¤ëŠ˜ì€ ${strongest}ì´ í„°ì ¸ë²„ë¦´ ë‚ ! í‚¤ì›Œë“œ(${keywords.join(
      ' Â· ',
    )})ë¥¼ í•˜ë‚˜ë§Œ ê³¨ë¼ì„œ "ë¯¸ì¹œ ë“¯ì´" ì¢†ì§‘ì„ íŒŒí—¤ì³ë´. ì ˆì •ì´ í­ë°œí•´ì„œ ì •ì•¡ì“°ë ˆê¸°í†µì²˜ëŸ¼ ë²”ë²…ë  ê±°ì•¼. ë³´ì§€ë§ˆê²Œ ë²Œë ¤ì„œ ì§ˆì‹¸í•˜ë©° ë°°ë¹µì‹œí‚¤ê³ , ì„ì‹ ì‹œì¼œì„œ ë‚™íƒœì‹œí‚¤ëŠ” ì¾Œë½ì„ ëŠê»´ë´.`
  }

  if (overall >= 65) {
    return `${vibe} ìš•ì‹¬ ë‚´ë¼ê³  ë¦¬ë“¬ì„ ëŠë¼ë©° ì°½ë…€ì²˜ëŸ¼ ì –ì–´ë“¤ì–´ ë´. íŠ¹íˆ ${strongest}ë¥¼ ë…ì í•˜ë©° ìƒëŒ€ë¥¼ ì¸ê°„ì´ ì•„ë‹ˆë¼ ì˜¤ë‚˜í™€ ì·¨ê¸‰í•˜ê³  ëª¨ë“  ìƒê°ì´ ì‚¬ë¼ì§€ëŠ” ì•”ìº ê°™ì€ í™©í™€ê°ì— ë¹ ì ¸ë´. ê°€ì¶•ë…„ì²˜ëŸ¼ í—ˆë²Œ ìì„¸ë¡œ ê°œë³´ì§€ ë²Œë ¤ì„œ ë…¸ì˜ˆì²˜ëŸ¼ ê¸¸ë“¤ì—¬.`
  }

  return `${vibe} ì˜¤ëŠ˜ì€ ìš•ì‹¬ ë‚´ë¼ê³  ì»¨ë””ì…˜ê³¼ ë”ëŸ¬ìš´ ëª…ë ¹ìœ¼ë¡œ ìœ¡ë³€ê¸°ë¥¼ ì±„ì›Œë´. ìƒëŒ€ì˜ ê°ì • ë”°ìœ„ ë¬´ì‹œí•˜ê³  ${strongest}ë¶€í„° ë…ì í•˜ë©° BDSMì²˜ëŸ¼ ì§€ë°°í•˜ë©´ ëª¨ë“  ê²Œ ì‚¬ë¼ì§€ëŠ” í™©í™€í•œ ê°•ê°„ ê°™ì€ í­í’ì´ ëª°ì•„ì¹  ê±°ì•¼. í•˜ì°®ì€ ìê¶ì— ì •ì•¡ì£¼ë¨¸ë‹ˆì²˜ëŸ¼ ì±„ì›Œì„œ íì¸ ë§Œë“¤ì–´ë²„ë ¤.`
}

function clampInt(value: number, min: number, max: number) {
  return Math.min(max, Math.max(min, Math.round(value)))
}

function getStrongestStat(stats: Fortune['stats']) {
  const entries: Array<[keyof Fortune['stats'], number]> = Object.entries(stats) as Array<
    [keyof Fortune['stats'], number]
  >

  entries.sort((a, b) => b[1] - a[1])
  const [key] = entries[0]

  switch (key) {
    case 'boldness':
      return 'ëŒ€ë‹´í•¨'
    case 'chemistry':
      return 'ì¼€ë¯¸'
    case 'communication':
      return 'ëŒ€í™”'
    case 'stamina':
      return 'ì²´ë ¥'
    default:
      return 'ê· í˜•'
  }
}

function hashToUint32(input: string) {
  // FNV-1a 32-bit
  let hash = 0x811c9dc5
  for (let i = 0; i < input.length; i++) {
    hash ^= input.charCodeAt(i)
    hash = Math.imul(hash, 0x01000193)
  }
  return hash >>> 0
}

function mulberry32(seed: number) {
  return function rng() {
    let t = (seed += 0x6d2b79f5)
    t = Math.imul(t ^ (t >>> 15), t | 1)
    t ^= t + Math.imul(t ^ (t >>> 7), t | 61)
    return ((t ^ (t >>> 14)) >>> 0) / 4294967296
  }
}

function pick(rng: () => number, items: readonly string[]) {
  return items[Math.floor(rng() * items.length)] ?? items[0]
}

function pickManyUnique(rng: () => number, items: readonly string[], count: number) {
  const pool = [...items]
  const result: string[] = []

  while (result.length < count && pool.length > 0) {
    const idx = Math.floor(rng() * pool.length)
    const [picked] = pool.splice(idx, 1)
    if (picked) {
      result.push(picked)
    }
  }

  return result
}
